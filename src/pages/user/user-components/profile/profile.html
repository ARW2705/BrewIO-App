<div  *ngIf="user"
      class="container">

  <ion-grid>

    <ng-container *ngIf="isLoggedIn()">

      <ion-row>

        <!-- User profile form -->
        <form [formGroup]="userForm"
              id="form">

          <!-- Email field (not form) -->
          <ion-item *ngIf="!isEditing('email', undefined)">

            <!-- Toggle editing mode for email -->
            <button (click)="changeEdit('email')"
                    class="profile-field-button">

              Email: <span>{{ userForm.value.email || 'NONE' }}</span>

            </button>

          </ion-item>

          <!-- Email field (form) -->
          <ion-item *ngIf="isEditing('email')">

            <ion-label floating>
              Email
            </ion-label>

            <ion-input  #email
                        formControlName="email"
                        (keyup.enter)="changeEdit('email', email)"
                        (ionBlur)="changeEdit('email', email)"
                        autocapitalize="off"
                        type="text">
            </ion-input>

          </ion-item>

          <!-- First name field (not form) -->
          <ion-item *ngIf="!isEditing('firstname')">

            <!-- Toggle editing mode for first name -->
            <button (click)="changeEdit('firstname', undefined)"
                    class="profile-field-button">

              First name: <span>{{ userForm.value.firstname }}</span>

            </button>

          </ion-item>

          <!-- First name field (form) -->
          <ion-item *ngIf="isEditing('firstname')">

            <ion-label floating>
              First name
            </ion-label>

            <ion-input  #firstname
                        formControlName="firstname"
                        (keyup.enter)="changeEdit('firstname', firstname)"
                        (ionBlur)="changeEdit('firstname', firstname)"
                        autocapitalize="off"
                        type="text">
            </ion-input>

          </ion-item>

          <!-- Last name field (not form) -->
          <ion-item *ngIf="!isEditing('lastname')">

            <!-- Toggle editing mode for last name -->
            <button (click)="changeEdit('lastname', undefined)"
                    class="profile-field-button">

              Last name: <span>{{ userForm.value.lastname }}</span>

            </button>

          </ion-item>

          <!-- Last name field (form) -->
          <ion-item *ngIf="isEditing('lastname')">

            <ion-label floating>
              Last name
            </ion-label>

            <ion-input  #lastname
                        formControlName="lastname"
                        (keyup.enter)="changeEdit('lastname', lastname)"
                        (ionBlur)="changeEdit('lastname', lastname)"
                        autocapitalize="off"
                        type="text">
            </ion-input>

          </ion-item>

        </form>

      </ion-row>

      <!-- Submit changes to user profile -->
      <ion-row *ngIf="hasValuesToUpdate()">

        <ion-col class="user-button-container">

          <!-- Button is disabled if data has not been changed -->
          <button ion-button
                  color="primary"
                  (click)="onUpdate()"
                  [disabled]="!userForm.valid">
            Update profile
          </button>

        </ion-col>

      </ion-row>

    </ng-container>

    <!-- Prompt user to login or signup if not logged in -->

    <ng-container *ngIf="!isLoggedIn()">

      <ion-row justify-content-center>

        <h2>
          Please log in to view or modify your profile
        </h2>

      </ion-row>

      <ion-row justify-content-around>
        <!-- Open login form modal button -->
        <ion-col  col-4
                  class="user-button-container">

          <button ion-button
                  color="primary"
                  (click)="openLogin()">
            Log In
          </button>

        </ion-col>

        <!-- Open signup form modal button -->
        <ion-col  col-4
                  class="user-button-container">

          <button ion-button
                  color="primary"
                  (click)="openSignup()">
            Sign Up
          </button>

        </ion-col>

      </ion-row>

      <!-- TODO: add login/signup buttons -->

    </ng-container>

  </ion-grid>

</div>
